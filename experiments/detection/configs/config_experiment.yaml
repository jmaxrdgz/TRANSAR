# config_experiment.yaml
# Configuration for YOLO detection experiments with timm backbones (SwinV2/ResNet/ConvNeXt)

SEED: 42

MODEL:
  NAME: YOLO
  IN_SIZE: 256
  IN_CHANS: 1  # SAR images are single-channel

  BACKBONE:
    NAME: swinv2_tiny_window8_256  # Options: swinv2_tiny_window8_256, resnet50, convnext_tiny, etc.
    PRETRAINED: true               # Use ImageNet pretrained weights
    WEIGHTS: null                  # Path to custom pretrained weights (overrides PRETRAINED if set)
    OUT_INDICES: [1,2,3]           # Multi-scale feature outputs (0 = shallow, 3 = deepest)

  # Progressive unfreezing
  NUM_BLOCKS_TO_UNFREEZE: 0  # 0 = freeze entire backbone, 1-4 = unfreeze last N blocks

  # YOLO detection parameters
  STRIDES: [8,16,32]  # Feature strides for P3, P4, P5
  ANCHORS:
    - [[10,13],[16,30],[33,23]]   # P3/8
    - [[30,61],[62,45],[59,119]]  # P4/16
    - [[116,90],[156,198],[373,326]]  # P5/32

  # Loss weights
  LOSS_WEIGHTS:
    BOX: 0.05   # Box regression loss weight
    OBJ: 1.0    # Objectness loss weight
    CLS: 0.5    # Classification loss weight

  # Inference parameters
  CONF_THRESHOLD: 0.25
  NMS_THRESHOLD: 0.45
  MAX_DETECTIONS: 300

DATA:
  DATA_PATH: dataset/supervised/PascalVOC
  NUM_CLASSES: 20  # Specify explicitly if known; otherwise null

  # SAR-specific normalization
  SAR_NORM_SCALE: null
  GLOBAL_STD: 1.5

  # Data augmentation
  AUGMENTATION:
    ENABLED: true
    COLOR_JITTER: true
    RANDOM_GAMMA: true

TRAIN:
  GPUS: 1
  NUM_WORKERS: 4
  EPOCHS: 50
  BATCH_SIZE: 8
  LR: 0.0001
  WEIGHT_DECAY: 0.0001
  LOG_FREQ: 10

  # Learning rate schedulers
  SCHEDULER:
    ENABLED: true
    MIN_LR: 0.00001

LOGGING:
  LOG_DIR: logs/detection_experiments
  TENSORBOARD: true
  SAVE_TOP_K: 3

EXPERIMENT:
  NAME: yolo_detection
  VERSION: null
  TAGS: []
